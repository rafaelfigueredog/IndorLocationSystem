close all;
clear;
clc;
 
beta_0 = 1.0;
Ptx = -59;
d = [1.0*ones(1,100) 1.5*ones(1, 100) 2.0*ones(1,100) 2.5*ones(1,100) 3.0*ones(1,100) 3.5*ones(1,100) 4.0*ones(1,100) 4.5*ones(1,100) 5.0*ones(1,100) 5.5*ones(1,100) 6.0*ones(1,100) 6.5*ones(1,100) 7.0*ones(1,100) 7.5*ones(1,100) 8.0*ones(1,100) 8.5*ones(1,100) 9.0*ones(1,100) 9.5*ones(1,100) 10.0*ones(1,100)];
%d = [1:.5:10].*ones(1,100);
d = d'


rssi = [-60 -62 -61 -61 -60 -60 -60 -63 -61 -62 -57 -60 -60 -57 -59 -60 -58 -60 -59 -58 -62 -62 -60 -59 -59 -58 -58 -59 -61 -59 -59 -57 -58 -58 -61 -60 -58 -60 -59 -59 -57 -58 -59 -59 -62 -59 -62 -58 -59 -58 -59 -60 -63 -63 -63 -59 -60 -60 -59 -59 -59 -61 -59 -60 -59 -59 -60 -60 -60 -60 -61 -61 -59 -60 -59 -62 -61 -63 -59 -59 -60 -60 -62 -61 -61 -63 -61 -61 -59 -59 -58 -59 -60 -60 -60 -59 -60 -60 -59 -59 -62 -72 -62 -61 -63 -61 -71 -60 -64 -74 -72 -68 -64 -71 -72 -73 -70 -59 -69 -62 -66 -69 -59 -67 -71 -65 -75 -67 -60 -61 -70 -69 -69 -70 -62 -70 -60 -66 -69 -62 -62 -68 -68 -70 -68 -70 -69 -69 -64 -71 -59 -64 -64 -62 -64 -69 -66 -59 -62 -59 -64 -69 -67 -59 -63 -67 -63 -69 -59 -62 -63 -69 -62 -69 -59 -58 -67 -64 -70 -71 -72 -64 -65 -68 -59 -59 -59 -64 -64 -60 -78 -59 -58 -60 -63 -60 -72 -71 -60 -65 -71 -73 -71 -67 -73 -74 -67 -69 -67 -70 -76 -70 -66 -73 -69 -72 -67 -67 -74 -71 -71 -74 -70 -72 -71 -73 -73 -70 -67 -70 -70 -73 -69 -67 -71 -72 -75 -74 -70 -69 -71 -68 -72 -67 -71 -71 -68 -71 -71 -72 -71 -72 -73 -76 -69 -68 -68 -75 -70 -69 -68 -76 -73 -76 -69 -73 -71 -68 -73 -69 -72 -72 -74 -67 -72 -68 -70 -69 -69 -69 -68 -69 -71 -70 -66 -69 -76 -73 -72 -73 -70 -72 -71 -68 -76 -72 -72 -68 -71 -66 -62 -62 -65 -65 -66 -67 -67 -68 -64 -69 -73 -68 -72 -66 -74 -64 -65 -67 -67 -68 -63 -68 -69 -67 -66 -63 -72 -68 -69 -67 -63 -69 -67 -63 -65 -68 -63 -68 -68 -67 -65 -71 -67 -71 -65 -65 -65 -66 -66 -66 -66 -66 -64 -63 -63 -62 -66 -64 -62 -68 -67 -65 -67 -63 -70 -62 -73 -70 -73 -63 -63 -69 -65 -73 -63 -63 -70 -69 -63 -65 -69 -68 -70 -70 -63 -63 -69 -70 -69 -70 -69 -70 -67 -62 -62 -72 -66 -66 -66 -71 -66 -65 -65 -68 -61 -65 -63 -68 -67 -63 -64 -63 -66 -63 -67 -65 -66 -62 -61 -65 -66 -63 -60 -61 -68 -69 -63 -67 -62 -61 -69 -68 -64 -60 -69 -66 -61 -62 -63 -64 -65 -62 -68 -62 -69 -63 -71 -64 -62 -66 -71 -63 -65 -71 -63 -65 -68 -69 -70 -72 -72 -68 -62 -62 -72 -64 -63 -64 -69 -61 -65 -60 -61 -60 -65 -60 -64 -66 -60 -59 -60 -66 -65 -62 -62 -65 -66 -59 -60 -68 -69 -68 -66 -63 -61 -60 -62 -63 -59 -60 -70 -66 -73 -67 -67 -77 -65 -79 -82 -79 -70 -71 -83 -86 -69 -67 -70 -68 -72 -68 -74 -68 -72 -69 -78 -70 -77 -79 -69 -65 -75 -67 -75 -64 -72 -66 -65 -77 -77 -66 -67 -69 -65 -65 -78 -76 -68 -77 -70 -69 -68 -65 -75 -72 -71 -69 -70 -72 -68 -70 -70 -77 -80 -74 -71 -78 -73 -79 -69 -71 -72 -72 -75 -77 -78 -79 -71 -71 -68 -76 -69 -76 -67 -70 -68 -75 -70 -67 -68 -76 -67 -78 -66 -66 -66 -73 -67 -69 -69 -67 -70 -71 -66 -69 -71 -71 -75 -66 -72 -69 -67 -69 -69 -70 -71 -68 -70 -70 -71 -69 -69 -69 -66 -67 -66 -68 -72 -67 -68 -69 -67 -66 -72 -66 -72 -67 -68 -66 -65 -68 -69 -68 -68 -70 -69 -75 -71 -69 -67 -72 -71 -69 -68 -70 -72 -68 -67 -76 -71 -71 -74 -72 -71 -70 -71 -69 -67 -67 -71 -71 -71 -68 -69 -70 -70 -69 -67 -71 -68 -67 -67 -66 -74 -67 -70 -68 -70 -69 -67 -68 -69 -68 -70 -68 -68 -68 -69 -71 -68 -66 -72 -75 -71 -72 -74 -74 -67 -72 -77 -68 -71 -73 -74 -76 -73 -74 -72 -73 -74 -74 -71 -69 -69 -73 -74 -74 -74 -73 -77 -68 -72 -73 -79 -69 -74 -74 -73 -78 -72 -71 -75 -73 -72 -79 -71 -74 -71 -76 -72 -70 -69 -72 -74 -73 -75 -76 -73 -71 -72 -73 -78 -75 -71 -74 -73 -74 -70 -70 -72 -75 -74 -74 -72 -72 -74 -70 -77 -71 -71 -69 -73 -72 -71 -71 -71 -69 -71 -75 -77 -72 -75 -76 -79 -76 -73 -73 -70 -73 -73 -76 -70 -77 -71 -73 -71 -72 -73 -80 -75 -74 -73 -78 -74 -75 -75 -75 -73 -76 -75 -75 -73 -74 -77 -71 -78 -72 -81 -78 -77 -76 -74 -69 -70 -77 -71 -74 -74 -72 -76 -77 -76 -80 -71 -72 -71 -75 -73 -76 -72 -75 -78 -74 -73 -80 -78 -79 -77 -76 -74 -76 -80 -80 -75 -76 -71 -76 -73 -73 -75 -73 -77 -73 -74 -76 -84 -80 -76 -71 -80 -76 -75 -72 -77 -79 -73 -71 -72 -75 -79 -75 -77 -75 -81 -75 -76 -75 -73 -79 -75 -76 -67 -66 -64 -65 -71 -70 -67 -67 -66 -73 -71 -71 -70 -72 -75 -64 -68 -70 -68 -67 -67 -65 -70 -66 -72 -69 -69 -67 -65 -69 -69 -67 -67 -65 -69 -69 -68 -72 -72 -69 -72 -69 -69 -68 -72 -65 -68 -69 -65 -66 -66 -68 -65 -66 -68 -68 -69 -67 -70 -70 -72 -65 -69 -73 -70 -69 -64 -77 -70 -67 -68 -75 -79 -68 -72 -64 -68 -68 -67 -66 -65 -69 -66 -67 -66 -70 -71 -65 -69 -70 -68 -65 -69 -69 -73 -64 -69 -66 -66 -66 -59 -65 -70 -78 -72 -62 -72 -59 -66 -66 -74 -74 -61 -70 -69 -73 -62 -59 -69 -66 -73 -60 -59 -61 -66 -69 -75 -66 -63 -68 -71 -76 -63 -61 -67 -73 -62 -69 -78 -74 -65 -70 -69 -62 -68 -73 -76 -61 -62 -67 -74 -60 -69 -70 -75 -70 -58 -75 -68 -71 -75 -74 -69 -71 -69 -68 -74 -61 -68 -71 -73 -74 -76 -67 -60 -75 -61 -60 -63 -66 -63 -66 -70 -65 -68 -73 -69 -73 -66 -62 -71 -64 -67 -70 -65 -63 -61 -66 -62 -65 -65 -75 -63 -70 -71 -66 -72 -67 -70 -74 -66 -62 -62 -69 -71 -71 -66 -71 -74 -70 -77 -69 -68 -68 -67 -66 -71 -74 -67 -73 -72 -75 -65 -77 -73 -73 -62 -69 -68 -67 -76 -73 -73 -68 -75 -68 -68 -64 -66 -76 -72 -72 -66 -69 -73 -71 -66 -68 -70 -70 -71 -71 -73 -68 -68 -74 -68 -75 -69 -63 -68 -72 -72 -63 -66 -71 -67 -67 -68 -68 -70 -71 -72 -63 -69 -67 -71 -62 -67 -70 -71 -67 -70 -66 -66 -71 -66 -66 -66 -67 -73 -73 -74 -66 -69 -65 -72 -70 -72 -69 -69 -71 -63 -66 -71 -74 -70 -67 -69 -72 -71 -70 -69 -74 -69 -70 -69 -65 -70 -73 -68 -75 -69 -66 -65 -70 -71 -68 -68 -73 -72 -69 -71 -72 -64 -74 -70 -70 -72 -68 -69 -74 -75 -64 -73 -72 -66 -72 -66 -73 -73 -65 -72 -74 -72 -72 -74 -73 -74 -64 -72 -76 -64 -72 -73 -69 -71 -73 -69 -67 -72 -70 -66 -65 -67 -71 -75 -72 -68 -73 -69 -66 -75 -72 -69 -70 -69 -73 -73 -71 -71 -74 -75 -72 -72 -72 -70 -70 -67 -70 -72 -68 -75 -70 -71 -72 -73 -72 -70 -74 -73 -72 -72 -72 -73 -72 -72 -68 -71 -73 -72 -71 -71 -68 -69 -69 -73 -72 -72 -72 -72 -71 -73 -72 -73 -72 -70 -73 -73 -72 -68 -72 -67 -69 -74 -72 -74 -72 -73 -70 -69 -73 -71 -77 -70 -71 -71 -73 -72 -74 -74 -70 -71 -73 -73 -71 -69 -73 -76 -71 -71 -73 -69 -69 -76 -73 -71 -74 -71 -70 -69 -77 -74 -70 -70 -70 -73 -73 -77 -73 -69 -60 -61 -61 -62 -61 -68 -69 -60 -63 -60 -67 -59 -68 -68 -68 -60 -62 -60 -61 -62 -64 -61 -67 -61 -59 -59 -59 -61 -61 -59 -61 -61 -68 -59 -62 -67 -61 -61 -62 -60 -67 -58 -61 -62 -61 -67 -61 -61 -65 -60 -62 -70 -66 -61 -61 -70 -66 -60 -60 -70 -62 -61 -68 -70 -61 -70 -62 -59 -60 -70 -59 -61 -62 -61 -62 -61 -69 -61 -69 -61 -59 -70 -62 -60 -61 -59 -65 -61 -61 -59 -61 -65 -69 -62 -62 -62 -62 -70 -65 -67 -66 -67 -64 -67 -61 -64 -62 -66 -60 -68 -68 -69 -67 -65 -69 -68 -64 -68 -69 -66 -65 -67 -64 -64 -71 -71 -67 -69 -69 -65 -66 -71 -70 -72 -66 -70 -74 -65 -66 -62 -68 -64 -66 -70 -69 -72 -70 -64 -62 -62 -66 -63 -71 -66 -64 -68 -67 -66 -67 -65 -66 -72 -69 -65 -72 -72 -64 -69 -63 -70 -69 -69 -63 -66 -69 -64 -71 -71 -67 -63 -69 -70 -71 -66 -71 -70 -68 -66 -70 -69 -64 -62 -63 -64 -70 -68 -68 -66 -64 -74 -69 -70 -72 -68 -69 -72 -68 -73 -72 -70 -70 -71 -72 -73 -68 -71 -70 -72 -75 -69 -71 -72 -71 -72 -74 -73 -69 -70 -69 -70 -73 -72 -68 -76 -68 -70 -71 -71 -71 -70 -78 -70 -68 -75 -72 -69 -74 -72 -76 -72 -70 -65 -74 -75 -72 -77 -76 -71 -75 -72 -72 -71 -69 -71 -74 -68 -70 -71 -66 -69 -71 -73 -75 -71 -73 -74 -73 -73 -71 -72 -69 -70 -70 -71 -72 -71 -71 -69 -70 -70 -68 -75 -71 -73 -73 -73 -75 -78 -73 -68 -63 -67 -79 -76 -66 -65 -64 -77 -79 -80 -65 -64 -66 -81 -66 -64 -66 -66 -80 -76 -66 -62 -66 -79 -76 -66 -63 -67 -80 -66 -80 -64 -65 -63 -64 -66 -65 -64 -65 -66 -63 -65 -65 -75 -80 -66 -68 -64 -64 -66 -66 -76 -76 -66 -78 -66 -76 -66 -68 -64 -68 -65 -80 -81 -79 -66 -81 -77 -66 -77 -66 -66 -67 -67 -80 -66 -66 -67 -67 -69 -65 -69 -80 -66 -80 -67 -64 -65 -68 -66 -66 -66 -65 -67 -64 -65 -66 -79 -66 -72 -67 -80 -68 -68 -67 -68 -68 -68 -72 -71 -72 -71 -68 -70 -66 -75 -73 -68 -71 -69 -68 -72 -69 -67 -68 -72 -73 -73 -71 -73 -70 -75 -72 -72 -73 -71 -69 -71 -68 -73 -68 -69 -73 -68 -68 -71 -70 -73 -69 -73 -70 -74 -68 -70 -70 -68 -67 -75 -73 -71 -74 -73 -77 -71 -71 -72 -70 -74 -73 -73 -70 -70 -73 -71 -74 -70 -70 -69 -74 -79 -75 -72 -73 -73 -74 -70 -78 -76 -73 -70 -72 -75 -73 -75 -72 -71 -71 -71 -70 ]; 
 
PL = Ptx - rssi;
PL = PL';
y = (PL - beta_0)/10;
x = log10(d);
 
 % Regressão Linear
 %% A = w*f
eta = (pinv(x'*x))*x'*y
%L = eta*x;
PLm = beta_0 + 10*eta*log10(d);
 
 % Plota o gráfico de Pd em função da gamma (em dB) para cada valor de Pfa
h = figure;
semilogx(d,PL, 'ko','LineWidth',1.5);
hold on;
semilogx(d,PLm, 'r','LineWidth',1.5);
legend('Dados    ','Modelo', 'Location','NorthWest');
xlabel('d (m)', 'FontSize', 16, 'FontName','Times');
ylabel('PL (dB)', 'FontSize', 16, 'FontName','Times');
grid on;
set(gca,'FontSize', 14);
set(gca,'FontName','Times');
set(gca,'LineWidth',1.5);
set(h,'Units','Inches');
pos = get(h,'Position');
set(h,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[pos(3), pos(4)]);

% % % Salva a figura no formato pdf
nomefigura = ['Graphic_LinearRegression'];
print(h,nomefigura,'-dpdf','-r0');

 
 
 